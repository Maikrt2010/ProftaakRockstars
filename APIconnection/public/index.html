<!DOCTYPE html>
<html>

<head>
    <title>Article editor</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script src="https://cdn.tiny.cloud/1/x5qtbwjjub75e8k47llgn2qnoctqja5ugz2qlr5cn7ctcj3p/tinymce/5/tinymce.min.js"
        referrerpolicy="origin"></script>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/article.css">
    <link rel="stylesheet" href="/css/tags-input.css">
    <div id="hero"></div>
    <style>
        .tags-input-wrapper {
            background: transparent;
            padding: 10px;
            border-radius: 4px;
            max-width: 400px;
            border: 1px solid #ccc
        }

        .tags-input-wrapper input {
            border: none;
            background: white;
            outline: none;
            width: 100%;
        }

        .tags-input-wrapper .tag {
            display: inline-block;
            background-color: #F3E300;
            color: rgb(0, 0, 0);
            font-size: 14px;
            border-radius: 40px;
            padding: 0px 3px 0px 7px;
            margin-right: 5px;
            margin-bottom: 7px;
            box-shadow: 0 5px 15px -2px rgba(250, 14, 126, .7)
        }

        .tags-input-wrapper .tag a {
            margin: 0 7px 3px;
            display: inline-block;
            cursor: pointer;
        }

        .containerinput {
            margin-left: 10%;
            margin-right: 10%;
        }

        .block {
            display: block;
            width: 100%;
            border: none;
            background-color: #F3E300;
            padding: 14px 28px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
        }

        .titlemake{
            text-align: center;
            font-size:150%
        }

    </style>
</head>

<body>

    <section class="hero">
        <div class="herocontainer">
            <figure class="heroimage">
                <a href=".index.html">
                    <img
                        src="https://www.teamrockstars.nl/sites/default/files/global_settings/logo-rockstars%402x_2.png">
                </a>
            </figure>

            <div class="titlebox">

                <h1 class="title titletext">
                    TECHBURST
                </h1>

                <h2 class="subtitle titletext">
                    DON'T KEEP IT IN THE BUBBLE - BURST IT
                </h2>
            </div>
        </div>

    </section>

    <ul class="navbar">
        <li><a href="/public/index.html">Home</a></li>
        <li><a href="#">Something</a></li>
        <li><a href="#">Something</a></li>
        <li><a href="#">Something</a></li>
        <li><a href="#">Something</a></li>
    </ul>


<div class="titlemake">
    <br><h1>Een nieuw artikel maken</h1><br>
</div>
    <div class="containerinput">
        <form id="post-data-form" method="post">
            
            <h3>Vul hier de titel van uw artikel in:</h3>
            <input type="text" id="title" placeholder="Titel">
            <h3>Vul hier uw naam in:</h3>
            <input type="text" id="author" placeholder="Auteur">
            <h3>Voeg hier tags toe:</h3>
            <input type="text" id="tag-input" placeholder="Tags"><br>
            <textarea id="texteditor"></textarea><br>
            <button type="submit" class="block">Post Data</button>
        </form>
    </div>



    <script>


        //javascript voor tags

        (function (factory) {

            if (typeof module == 'object' && typeof module.exports == 'object')
                module.exports = factory();
            else if (typeof window == 'object')
                window.TagsInput = factory();
            else
                console.error('To use this library you need to either use browser or node.js [require()]');

        })(function () {
            "use strict"

            var initialized = false

            // Plugin Constructor
            var TagsInput = function (opts) {
                this.options = Object.assign(TagsInput.defaults, opts);
                this.init();
            }

            // Initialize the plugin
            TagsInput.prototype.init = function (opts) {
                this.options = opts ? Object.assign(this.options, opts) : this.options;

                if (initialized)
                    this.destroy();

                if (!(this.orignal_input = document.getElementById(this.options.selector))) {
                    console.error("tags-input couldn't find an element with the specified ID");
                    return this;
                }

                this.arr = [];
                this.wrapper = document.createElement('div');
                this.input = document.createElement('input');
                init(this);
                initEvents(this);

                initialized = true;
                return this;
            }

            // Add Tags
            TagsInput.prototype.addTag = function (string) {

                if (this.anyErrors(string))
                    return;

                this.arr.push(string);
                var tagInput = this;

                var tag = document.createElement('span');
                tag.className = this.options.tagClass;
                tag.innerText = string;

                var closeIcon = document.createElement('a');
                closeIcon.innerHTML = '&times;';

                // delete the tag when icon is clicked
                closeIcon.addEventListener('click', function (e) {
                    e.preventDefault();
                    var tag = this.parentNode;

                    for (var i = 0; i < tagInput.wrapper.childNodes.length; i++) {
                        if (tagInput.wrapper.childNodes[i] == tag)
                            tagInput.deleteTag(tag, i);
                    }
                })


                tag.appendChild(closeIcon);
                this.wrapper.insertBefore(tag, this.input);
                this.orignal_input.value = this.arr.join(',');

                return this;
            }

            // Delete Tags
            TagsInput.prototype.deleteTag = function (tag, i) {
                tag.remove();
                this.arr.splice(i, 1);
                this.orignal_input.value = this.arr.join(',');
                return this;
            }

            // Make sure input string have no error with the plugin
            TagsInput.prototype.anyErrors = function (string) {
                if (this.options.max != null && this.arr.length >= this.options.max) {
                    console.log('max tags limit reached');
                    return true;
                }

                if (!this.options.duplicate && this.arr.indexOf(string) != -1) {
                    console.log('duplicate found " ' + string + ' " ')
                    return true;
                }

                return false;
            }

            // Add tags programmatically 
            TagsInput.prototype.addData = function (array) {
                var plugin = this;

                array.forEach(function (string) {
                    plugin.addTag(string);
                })
                return this;
            }

            // Get the Input String
            TagsInput.prototype.getInputString = function () {
                return this.arr.join(',');
            }


            // destroy the plugin
            TagsInput.prototype.destroy = function () {
                this.orignal_input.removeAttribute('hidden');

                delete this.orignal_input;
                var self = this;

                Object.keys(this).forEach(function (key) {
                    if (self[key] instanceof HTMLElement)
                        self[key].remove();

                    if (key != 'options')
                        delete self[key];
                });

                initialized = false;
            }

            // Private function to initialize the tag input plugin
            function init(tags) {
                tags.wrapper.append(tags.input);
                tags.wrapper.classList.add(tags.options.wrapperClass);
                tags.orignal_input.setAttribute('hidden', 'true');
                tags.orignal_input.parentNode.insertBefore(tags.wrapper, tags.orignal_input);
            }

            // initialize the Events
            function initEvents(tags) {
                tags.wrapper.addEventListener('click', function () {
                    tags.input.focus();
                });


                tags.input.addEventListener('keydown', function (e) {

                    var str = tags.input.value.trim();

                    if (!!(~[9, 13, 188].indexOf(e.keyCode))) {
                        tags.input.value = "";
                        if (str != "")
                            tags.addTag(str);
                    }

                });
            }


            // Set All the Default Values
            TagsInput.defaults = {
                selector: '',
                wrapperClass: 'tags-input-wrapper',
                tagClass: 'tag',
                max: null,
                duplicate: false
            }

            return TagsInput;
        });











        $(document).ready(function () {
            $(window).keydown(function (event) {
                if (event.keyCode == 13) {
                    event.preventDefault();
                    return false;
                }
            });
        });
        tinymce.init({
            selector: "#texteditor",
            plugins: 'autoresize, image code',
            menubar: false,
            theme_advanced_blockformats : 'h2,h3,p',
            toolbar: " undo redo | styleselect | bold italic underline| link | print preview media fullpage | image", 
            placeholder: "Typ hier uw artikel ..."
        });

        $(document).ready(function () {
            let article;
            let title;
            let author;
            let tag;
            $("#post-data-form").submit(function (e) {
                article = tinymce.get("texteditor").getContent();
                title = document.getElementById("title").value;
                author = document.getElementById("author").value;
                tag = document.getElementById("tag-input").value;
                const data = { article, title, author, tag };
                const options = {
                    method: 'POST',
                    body: JSON.stringify(data),
                    headers: {
                        "Content-Type": "application/json"
                    }
                }
                title = "<h1 style= \"font-size:150px; text-align:center\">" + title + "</h1>";
                document.body.innerHTML = title + article;
                fetch('/api', options);
                return false;
            });
        });


    </script>





    <!-- <script src="/js/tags-input.js"></script> -->

    <script>
        var tagInput1 = new TagsInput({
            selector: 'tag-input',
            duplicate: false,
            max: 10
        });
    </script>


</body>

</html>